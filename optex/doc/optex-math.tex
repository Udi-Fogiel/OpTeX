\fontfam[lmfonts]

\font\ttlib=[LiberationMono-Regular]
\def\ttspec{\let\_ttfont=\ttlib}

\report

\def\new #1 {\mnote{\Red$\blacktriangleleft$\,\sans\setfontsize{at9pt}\rm#1}}
\fixmnotes\right
\enquotes
\activettchar`
\catcode`\<=13
\def<#1>{$\langle\hbox{\it#1\/}\rangle$}
\everyintt={\catcode`\<=13 }


\tit Typesetting Math with \OpTeX/

\author Petr Olšák

This document is a brief summary about typesetting math. It describes \TeX/,
Plain \TeX/ and \OpTeX/ features concerned to math.  The first two types of
features are documented in \TeX/book in chapters 16, 17 and 18, but it is
sumarized here in short again in order to give a complete guide about math
typesetting for \OpTeX/ users.

\new {}
The \OpTeX/ features which differs from standard \TeX/ or Plain \TeX/ are
documented with the red triangle at the margin (like in this paragraph).
Reader can simply distinguish between \"standard" features (given by 
\TeX/ or Plain \TeX/) and new \OpTeX/ features.

There are more types of extensions: e\TeX, lua\TeX/, Unicode math and
\OpTeX/ macros. The appropriate label (e\TeX, Lua\TeX/, Unicode, \OpTeX/) 
is appended to the red triangle to inform you about the extension type.
Nevertheless, \OpTeX/ user doesn't have to worry about it, all extensions 
are available if Unicode Math font is loaded (e.g.,\ by the command
`\fonfam[lmfonts]`). See section 1.3.3 in \OpTeX/ documentation about 
loading Unicode math fonts.

\bigskip
\maketoc
\vfil\break

\sec Basics structure of math formulas

\secc General rules and terminology

The in-line math (in the paragraph) is created by `$<math list>$`. The
display math (standalone line between paragraphs) is created by `$$<math list>$$`.
More than one line can be here if appropriate macro is used. In-line math is
processed in a \TeX/ group in {\em in-line math mode}. The display math is
processed in a \TeX/ group in {\em display math mode}. Spaces are
ignored in math modes.

The <math list> is a sequence of {\em math atoms} and {\em other materials}. 
The math atoms are {\em single math objects} or composed math atoms.

\begitems
* The single math object is a single character to be printed in math mode
  like `x`, `+`, `\int`.
* The math atom is constructed in genereal by `{<mat list 1>}^{<math list 2>}_{<math list 3>}`.
  It consists from {\em nucleus} <math list 1>, exponent <math list 2> and subscript 
  <math list 3>. Each part of the atom should be empty. If the mentioned <math list>
  consist only from a single math object then we need not to use brackets, for example
  `x^2` is a math atom with `x` in nucleus, `2` in exponent and with empty subsript.
  Or `a_{i,j}` is a math atom with `a` in nucleus, empty exponent and `i,j` in substript.
  The constructors for exponent `^` and for subscript `_` can be used in arbitrary order 
  followed by the nucleus, for example `z_1^{x+y}` it the same math atom as
  `z^{x+y}_1`.
  The single math objects which is not followed by `^` nor `_` are
  considered as math atoms with this object in nucleus and with empty
  exponent and subscript (this is very common case). 
  \TeX/ assigns the {\em class} for each math atom, see section~\ref[class].
* Other material can be \TeX/ box or glue (space) or `\kern` or `\vrule` etc. 
\enditems

Example: The `Z = \int``_\Omega x^{2y} + z\, dx` generates 
$Z = \int_\Omega x^{2y} + z\, dx$ and it is <math list> which consists from:

\begitems
* `Z` is math atom with empty exponent and substript, class: Ord,
* `=` is math atom with empty exponent and substript, class: Rel,
* `\int``_\Omega` is math atom with empty exponent and with substript `\Omega`, class: Op,
* `x^{2y}` is math atom with exponent `2y` and empty substript, class: Ord,
* `+` is math atom with empty exponent and substript, class: Bin,  
* `z` is math atom with empty exponent and substript, class: Ord,
* `\,` is other other material, the glue (space) in this case,
* `d` is math atom with empty exponent and substript, class: Ord,
* `x`is math atom with empty exponent and substript, class: Ord.
\enditems

\secc[class] Classes of math atoms

\TeX/ gives {\em a class} for each math atom.\fnote
{Using terminology of \TeX/book, each single math object has its {\em class} but the 
 math atom has its {\em kind} derived from this class. I use only one word
 for both meanings in this document.}
This data type is used when
\TeX/ decides about horizontal spaces between atoms. For example
`xy` prints two atoms without space between them but `x+y` is printed with
small spaces around the `+` binary operator. Compare: $xy$ and $x+y$.

The class is set depending on the nucleus of the atom. If the nucleus is
not single math object, i.e. it is constructed by `{<math list>}` with braces
then the atom has its class Ord. If the nucleus is single math object constructed
without braces then the class of the atom depends on this single math
object. Each single math object must be declared in \TeX/ with its default
class. The following table lists the classes with typical examples.
Full set of all math objects used in math typesetting 
is listed in the section~\ref[objects] with their default classes.

\bigskip
\noindent\hfil\table{lll}{
   Class  & Meaning          & Example \crl
   Ord    & ordinary object  & variables, digits, $x, {\bbchar R}, \Gamma, 0, 1$ \cr
   Op     & big opertator    & $\sum, \int$ \cr
   Bin    & binary operator  & $+, \times, -$ \cr
   Rel    & reations         & $=, \ne, \leq, \supseteq$ \cr
   Open   & opening bracket  & $\{, (, [$ \cr
   Close  & closing bracket  & $\}, ), ]$ \cr
   Punct  & punctuation      & comma \cr
   Inner  & left-right       & \code{\\left...\\right} outputs, see section~\ref[delims]
}
\bigskip

There are three spaces used by the algoritmh for horizontal spacing in the
math formulas.

\begitems
* Thin space:   `\thinmuskip` primitive register, `\,` macro. Used around Op atoms.
* Medium space: `\medmuskip` primitive register, `\>` macro. Used around Bin atoms.
* Thick space: `\thickmusip` primitive register, `\;` macro. Used around Rel atoms. 
\enditems

\puttext 7.8cm -3.7cm {\rotbox{90}{Left atom}}
\puttext 11.5cm  -.5cm  {Right atom}
\puttext 8.2cm -4.4cm {\typosize[9/11]
\thistable{\def\_enspace{ }}%
\table {l|8c|} {
  \omit & Ord & Op & Bin & Rel & Open & Close & Punct & \omit \hfil Inner \crlp{2-9}
  Ord   &  0  &  1 &  2  &  3  &  0   &  0    &  0    &  1  \cr
  Op    &  1  &  1 &     &  3  &  0   &  0    &  0    &  1  \cr  
  Bin   &  2  &  2 &     &     &  2   &       &       &  2  \cr
  Rel   &  3  &  3 &     &  0  &  3   &  0    &  0    &  3  \cr
  Open  &  0  &  0 &     &  0  &  0   &  0    &  0    &  0  \cr
  Close &  0  &  1 &  2  &  3  &  0   &  0    &  0    &  1  \cr
  Punct &  1  &  1 &     &  1  &  1   &  1    &  1    &  1  \cr
  Inner &  1  &  1 &  2  &  3  &  1   &  0    &  1    &  1 \crlp{2-9}
}}

\hangindent=-8.7cm \hangafter=0
Ord atoms are printed without spaces between them. The spaces are not
cummulated, so the rules about spaces mentioned above is only rough idea.
The exact rule for horizontal spaces is given for each pairs of atoms 
in the table here. The symbol 0 means no space, 1 thin space, 2 medium space
and 3 means thick space.

\hangindent=-8.7cm \hangafter-2
The Bin atom is automaticaly transformed to the
Ord atom if no atom precedes or if Op, Bin, Rel, Open or Punct atom
precedes. And it is transformed to the Ord atom if Rel, Close or Punct atom
follows. This corresponds to the empty cells in the table.
Why such behavior? Compare \"\hbox{$0-1$}" and \"$-1$". The Bin atom in
the second case behaves like Ord atom, there is no space
between minus and one.

All medium spaces and thick spaces and some thin spaces from this table are
omitted if the <math list> is processed in script or scriptscript styles
(smaller size). See section~\ref[styles] about math styles.

You can overwrite the default class derived from the nucleus of the atom by
\TeX/ primitives `\mathord`, `\mathop`, `\mathbin`, `\mathrel`, `\mathopen`,
`\mathclose`, `\mathpunct` and `\mathinner`. They can precede a nucleus of
the atom and they set the class of the atom.
For example, `x \mathrel+ y` behaves like `x = y` in spacing pint of view but +
is printed. Another example: `\mathop{\rm lim} z` creates the atom `lim` in
roman font of class Op. So, the thin space is inserted between lim and $z$.

There are more special kinds of math atoms: fractions, math accents,
radicals. They are constructed by special way (see next sections) but they behaves
like Ord atom in the horizontal spacing algorithm. 

\secc[styles] Math styles

When a formula (or a sub-formula) is processed by \TeX/ then one from four
slyles is active: display style ($D$), text style ($T$), script style ($S$) or
scriptscript style ($SS$). 

The $T$ style is started in in-line math mode `$...$` and the $D$
style is started in display math mode `$$...$$`. The first level of exponents or
subsripts are processed in $S$ style and the second and more levels of
exponents or indexes are processed in $SS$ style.
There are special rules for math styles when fractions are constructed, see
section~\ref[frac].

The $D$ and $T$ style uses basic font size, $S$ uses smaller font size (typically
70~\%) and $SS$ style uses more smaller font size (typically 50~\%). 

The nucleus of Op atoms (big operators, $\sum$, $\int$ etc.) have typicaly bigger versions
of the character shape for $D$ style than for $T$ style. 
So, there are four sizes for such math
objects: one size for each math style. All other math objects (with non Op
class) are printed only in three sizes: The sizes for $T$ and $D$ styles are equal.

The Op atom puts its exponent and subscript above and below the nucleus in $D$
style but right to the nucleus in other styles:
$$
  `\sum``_{i=1}^\infty` \quad \hbox{gives}\quad \sum_{i=1}^\infty \hbox{ in $D$ style and}
  \quad \textstyle \sum_{i=1}^\infty \hbox{ in $T$ style}.
$$
This default behavior of the Op atom
can be modified by placing `\limits` or `\nolimits` or
`\displaylimits` \TeX/ primitive just after the Op nucleus before the constructors
of exponent and/or index. The `\nolimits` puts exponent and subscript right
to the nucleus (regardles of the current style) and `\limits` puts these
objects above and below the nucleus (regardless of the current style). There
can be more such primitives in a queue (due to a macro expannsion, for
instance). Then the last primitive in the queue wins. 
If the last primitive is `\displaylimits` then 
default behavior is processed regardles there are `\limits` or `\nolimits`
before it.
$$
  `\sum\nolimits``_{i=1}^\infty` \quad \hbox{gives}\quad \sum\nolimits_{i=1}^\infty
$$
Atoms of all other classes have their exponents and/or subscripts only right
to their nucleus without any exception.

The primitives `\displaystyle`, `\textstyle`, `\scriptstyle` and
`\scriptscriptstyle` set the given style regardles the default rules. For
example, you can create a formula in in-line math mode and in $D$ style by
`$\displaystyle <fomula>$` or a formula in in display mode and $T$ style can be printed
by `$$\textstyle <fomrula>$$`.

If the subformula is placed below something (below a rule from root symbol,
below a fraction rule), then the processed style $D, T, S$ or $SS$ is {\em cramped}.
The exponents are positioned slightly lower than in non-cramped style.

Several macros need to know what math style is currently processed (for
example they need to draw something in an appropriate size). But is
not possible simply due to the syntax of fractions (section~\ref[frac]).  
This syntax requires to process all math lists in two steps: the first step
expands all macros and creates structured data of processed math list. The
second step reads the otput of the first step and switches between math
styles and creates definitive output. So, macros cannot know the current math
style which is set only in the second step. \TeX/ supports the primitive
`\matchchioce{<D>}{<T>}{<S>}{<SS>}` which prepares four math lists in the
first step and only one of these four lists are used in the second step. We
can put different macros into each of the four parameters of `\mathchoice`.
Plain \TeX/ supports the macro `\mathpalette` which gives a more comfortable
interface of `\mathchoice` to macro programmer.

\new \OpTeX/
We decribe another interface for creating macros depending on current
style. You can use `\mathstyles{<math list>}`. It 
behaves like `{<math list>}`, but you can use following commands inside such
<math list>:
\begitems
* The macro `\currstyle`. It expands to 
  `\displaystyle`, `\textstyle`,
  `\scriptstyle` or `\scriptscriptstyle` depending on the current math style
  when the `\mathstyles` was opened. 
* The `\dobystyle{<D>}{<T>}{<S>}{<SS>}` is expandable macro. It expands its
  parameter `<D>`, `<T>`, `<S>` or `<SS>` depending on the current math style
  when `\mathstyles` was opened.
* The value of the `\stylenum` register is 0, 1, 2 or 3 
  depending on the current math style when `\mathstyles` was opened.  
\enditems
%
Example of usage of `\mathstyles`:
\def\mysymbol{\mathbin\mathstyles
   {\kern1pt\vrule height\mysymbolA width\mysymbolA\kern1pt}}
\def\mysymbolA{\dobystyle{5pt}{5pt}{3.5pt}{2.5pt}}
\begtt
\def\mysymbol{\mathbin\mathstyles
   {\kern1pt\vrule height\mysymbolA width\mysymbolA\kern1pt}}
\def\mysymbolA{\dobystyle{5pt}{5pt}{3.5pt}{2.5pt}}
Test: $a\mysymbol b_{c \mysymbol d}$ or $a\mysymbol b\over c$.
\endtt
This example gives Test: $a\mysymbol b_{c \mysymbol d}$ or $a\mysymbol b\over c$.

The `\mathstyles` macro mentioned above uses \TeX/ primitive `\mathchoice`, so it
creates four math lists and only one is used. It may take more
computer time in special cases. 
\new Lua\TeX/
Lua\TeX/ supports the `\mathstyle` primitive 
(no \"`s`" at the end of this control sequence) which
returns values 0 to 7 depending on the current style: 
$D, D', T, T', S, S', SS, SS'$ 
(where $X'$ means cramped variant of the style). This primitive does
not use `\mathchoice` but it simply ingnores the fraction syntax, so
`$a\symbol b\over c$` cannot work if `\symbol` is defned using the `\mathstyle`
primitive. See section 7.3.1 of Lua\TeX/ documentation for more information.  


\secc[frac] Fractions

The fraction can be constructed by `{<numerator>\over<denominator>}`. If the
fraction is only single object in the whole math mode (between dollars), 
you need not to use the outer braces, so you can write `$1\over2$` to get $1\over2$.

The <numerator> and <denomiator> are printed in \"smaller" math style than
current math style. More exactly the following shema is used. 
$D$: $T\over T$., $T$: $S\over S$, $S$: $SS\over SS$, $SS$: $SS\over SS$.
For example
$$
  `{a+b \over c}` \quad \hbox{is printed as }
   {a+b\over c} \hbox{ in $D$ style and as }
   \textstyle {a+b\over c} \hbox{ in $T$ style}.
$$

The \LaTeX/ macro `\frac{<numerator>}{<denominator>}` is not supported in
Plain \TeX/ nor in \OpTeX/ but you can define such macro if you want.

The syntax with `\over` is more preferred because it is more human readable
notation. You can write the fraction in the same manner as you can read it.
You can compare: `$1\over2$` (one over two) with `$\frac12$` (frac twelve).

Besides the `\over` primitive, there are analogical \TeX/ primitives which
create \"generalized" fractions. The result is similar as `{<above>\over <below>}`
but there is something extra:

\begitems
* `{<above>\atop <below>}` does `{<above>\over<below>}` but
  without the fractional rule.
* `{<above>\above<dimen><below>}` creates fractional rule with <dimen> thickness.
* `{<above>\overwithdelims<delim-l><delim-r><below>}` adds the <delim-l> left to
  the fraction and the <delim-2> right to the fraction.
* `{<above>\atopwithdelims<delim-l><delim-r><below>}` is analogical to
  `\overwithdelims` but without fractional rule.
* `{<above>\abovewithdelims<delim-l><delim-r><dimen><below>}` behaves as
  `\overwithdelims` but the fractional rule has <dimen> thickness.
\enditems
%
The `\...withdelims` variants read <delim-l> and <delim-r>, they must be
declared as {\em math delimiter} in \TeX. They are vertically scalable
math objects, typically brackets. See section~\ref[delims] for more
information about math demiliters. Example:
$$
 `{n \atopwithdelims() k}`\quad \hbox{ creates } 
  {n \choose k} \hbox{ in $D$ style and }
  \textstyle {n \choose k} \hbox{ in $T$ style}.
$$
The `\choose` macro is defined by `\def\choose{\atopwithdelims()}`, so the
user can write `{n\choose k}` in order to get binomical coefficients.


\secc[delims] Vertically scalable objects: math delimiters 

The vertically scalable objects are called {\em delimiters}. For example,
all brackets are declared as delimiters. 
This means that you can use a bracket in arbitrary
vertical size.\fnote{
This is not exactly true, because traditional typography says that they
cannot be scaled continuosly but by visible steps. This means that there is
a sequence of increasing brackets, reader must see a difference between each 
two sizes of brackets.}

The following objects are declared as delimiters (i.e.\ vertically scalable):

\bigskip
{\tt \adef!{\bslash}
\table{l 14c}{
 \rm source: & ( & ) & [ & ] & \code{\\\{} & \code{\\\}} & /  
             & !backslash & !langle & !rangle 
             & | & \code{\\|} & \cr   
 \rm output: &$($&$)$&$[$&$]$& $\{$  & $\}$ & $/$ 
             & $\backslash$ & $\langle$ & $\rangle$ 
             & $|$ & $\|$
}
\medskip
\table{l 14c}{
 \rm source: & !lfloor & !rfloor & !lceil & !rceil \cr
 \rm output: &  $\lfloor$  & $\rfloor$ & $\lceil$ & $\rceil$ 
}
\medskip
\table{l 14c}{
 \rm source: & !uparrow & !Uparrow & !dowarrow & !Downarrow 
             & !updownarrow & !Updownarrow \cr
 \rm output: & $\uparrow$ & $\Uparrow$ & $\downarrow$ & $\Downarrow$
             & $\updownarrow$ & $\Updownarrow$
}}
\bigskip
\noindent \new Unicode
If you are able to produce the characters $\langle$, $\rangle$,\fnote
 {Do not confuse $\string<, >$ and $\langle, \rangle$. The first pair are Rel atoms
  with meaning \"less than" or \"greater than", but the second pair are special
  types of brackes. They are not directly availbale at computer keyboards without 
  using a keyoard macro.}
$\lfloor$, $\rfloor$, ... $\updownarrow$, $\Updownarrow$ 
directly in your text editor then you can use these Unicode characters in your source instead of control
sequences `\langle`, `\rangle`, `\lfloor`, `\rfloor` ... `\updownarrow`, `\Updownarrow`.
For many users (including me), there is more simple to type `\lfloor` than to find
how to create the $\lfloor$ character in my text editor. Note that there exist 
text editors (Emacs, for example)
enabling you to type `\lfloor` and this control sequence is immediatelly
converted to the $\lfloor$ Unicode character. 
Your source looks pretty and you can use classical \TeX/ sequences.

\new Unicode
There are more delimiters, but it heavily depends on loaded Unicode Math
font. For example, this document is printed in `latinmodern-math` font and
there are six more delimiters `\lBrack`~$\lBrack$, `\rBrack`~$\rBrack$, 
`\lAngle` $\lAngle$, `\rAngle` $\rAngle$, `\lgroup` $\lgroup$, `\rgroup` $\rgroup$. 
See section~\ref[objects] for table of all Unicode symbols for math typesetting.

Arbitrary tall formula can be surrounded by a pair of delimiters using
`\left` and `\right` \TeX/ primitives: `\left<delim> <formula> \right<delim>`.
The delimiters are scaled to the height and depth of the <formula>
and vertically centered to the {\em math axis}.\fnote
{Math axis is a horizontal line passing through the center of symbols $+$
 and $-$. All vertically scalable objects are vertically centeted with
 respect to this axis.} 
Example:
$$
  `+ \left\{ \sum_{i=1}^\infty x_i \right)` \quad \hbox{ gives }  
   + \left\{ \sum_{i=1}^\infty x_i \right).
$$
The pair `\left<delim> <formula> \right<delim>` creates the formula in a
\TeX/ group. Such group can be nested with another groups. 
Each `\left` must have its `\right` counterpart at the same group level.
If you don't want to create visible delimiter, use dot instead <delim>.
Example:
$$
  `\left. \int``_0^t e^{x^2}\,dx\, \right|_{t=42}` \quad \hbox{ gives }
   \left. \int_0^t e^{x^2} \,dx\, \right|_{t=42}
$$
 
\new e\TeX/
You can use `\middle<delim>` inside the <formula> which is surrounded by
`\left...\right`. Then the given <delim> is scaled in to the same size like
their `\left` and `\right` counterparts. 

When a delimiter is used without `\left` nor `\right` prefix, the it is the
Open, Close, Ord or Bin atom by its natural meaning:
$(, [, \{, \ldots, \lfloor, \lceil$ are Open atoms,
$], ], \}, \ldots, \rfloor, \rceil$ are Close atoms, 
$/, \backslash, |, \|$ are Ord atoms and 
$\uparrow, \Uparrow, \ldots, \Updownarrow$ are Bin atoms. You can overwrite
this default setting, for example `\mathclose(`. If delimiters are used with
`\left` and `\right` prefixes then `\left<delim>` behaves like Open atom,
`\right<delim>` behaves like Close atom and the math list
`\left<delim><formula>\right<delim>` is encapsulated as a single Inner atom.
The `\middle<delim>` behaves like Open atom at its left side and like Close
atom at its right side. 

The sequence of increasing delimiters can be printed by the following
macros:
$$
  `(` \to (,\quad `\big(` \to \big(,\quad `\Big(` \to \Big(,\quad
  `\bigg(` \to \bigg(, \quad `\Bigg(` \to \Bigg(.
$$
The `\Bigg<delim>` is not maximal size of the bracket. Try 
`\left(\vbox to5cm{}\right.`, for example. You can see that the font 
\"cheats" from certain sizes, because there are not all infinity number of
sizes of brackets drawn in the font, of course.

The `\big<delim>` creates Ord atom. We need to create Open atom
for opening bracket and Close atom for closing bracket more often. 
Then we can use macros
`\bigl<delim>`, 
`\Bigl<delim>`, 
`\biggl<delim>`, 
`\Biggl<delim>` for creating Open atoms and
`\bigr<delim>`, 
`\Bigr<delim>`, 
`\biggr<delim>`, 
`\Biggr<delim>` for creating Close atoms. Unfortunately, the source is not
too attractive when more sizes of brakets are used, but typography
tratidions say that we must distinguish brackets by the size in math
mode if they are in equal shapes:
$$
  `\Bigl( f\bigl( 2(x+y) + z\bigr) \Bigr)'` \quad \hbox{gives }
  \Bigl(f\bigl(2(x+y)+z\bigr)\Bigr)'. 
$$

\secc Horizontally scalable objects: math accents

Arbirtrary wide formula can be covered by {\em scalable math accent}.
Example:
$$
  `\overrightarrow {a+b+c+d+e+f}` \quad \hbox{gives } \overrightarrow {a+b+c+d+e+f}.
$$
The usage is: control sequence of selected math accent followed by `{<math list>}`.

Standard scalable math accents are: 
`\overline` $\overline{abc}$, 
`\overbrace` $\overbrace{abc}$,
`\overrightarrow` $\overrightarrow{abc}$,
`\overleftarrow`~$\overleftarrow{abc}$, 
`\underline` $\underline{abc}$,
`\underbrace` $\underbrace{abc}$.

A special Accent atom is created. The exponents and subscripts are centered above
and below the nucleus of this atom (regardless of the current style). Example:
$$
  `\overbrace {b\cdot b\cdot b \cdots b}^{k\times}` \quad \hbox{gives }
  \overbrace {b\cdot b\cdot b \cdots b}^{k\times}
$$
There are scalable accents with limited maximum width:
`\widehat` $\widehat{abc}$ and `\widetilde` $\widetilde{abc}$. If the
formula is wider than the font is able to cover then widest variant from the
font is used and it is horizontally centered.

\new Unicode
There are more scalable accents in Unicode math fonts:
`\overparen` $\overparen{abc}$, `\underparen` $\underparen{abc}$,
`\overbracket` $\overbracket{abc}$, `\underbracket` $\underbracket{abc}$,
`\overleftrightarrow` $\overleftrightarrow{abc}$,
`\overleftharpoon` $\overleftharpoon{abc}$,
`\overrightharpoon` $\overrightharpoon{abc}$,


\secc Fixed math accents

Fixed math accents can be applied to single math object or to the `{<math list>}`. 
The accent is centered (with respect of slanting axis) and the result is a
nucleus of Ord
atom. For example `\dot x` gives $\dot x$. The list of fixed math accents
follows: `\acute x` $\acute x$, `\bar x` $\bar x$, 
`\breve x` $\breve x$, `\check a` $\check a$, 
`\dot x` $\dot x$, `\ddot x` $\ddot x$, 
`\grave x` $\grave x$, `\hat x` $\hat x$, 
`\vec x` $\vec x$, `\tilde x` $\tilde x$.

\new Unicode
The additional fixed accents depends on used Unicode math font. The
`latinmodern-math` supports:
`\ovhook x` $\ovhook x$, `\ocirc x` $\ocirc x$, 
`\leftharpoonaccent x` $\leftharpoonaccent x$, `\rightharpoonaccent x` $\rightharpoonaccent x$, 
`\dddot x` $\dddot x$, `\ddddot x` $\ddddot x$, 
`\widebridgeabove x` $\widebridgeabove x$, `\asteraccent x` $\asteraccent x$. 

\secc Roots

There is a macro `\sqrt{<math list>}` to create square root. For example:
$$
  `\sqrt{\sqrt{\sqrt{x+1}+1}+1}` \quad \hbox{gives }
   \sqrt{\sqrt{\sqrt{x+1}+1}+1}
$$
The $n$-th root is created by the macro `\root n\of{<math list>}`. For
example `\root k+1\of x` gives $\root k+1\of x$.

\secc Math alphabets

Letters $a\dots z$, $A\dots Z$ and $\alpha$\dots$\omega$ are printed in italics
in math mode. This follows the traditional typographical rule. 
All other math symbols, digits and uppercase Greek letters must be
unslanted.\fnote
{French typographical rule says that uppercase Greek letters have to be
 slatned too.}

If we want to use the letters or digits 
in another than this default shape, then we can use
{\em math alphabet selectors}: `\mit`, `\rm`, `\it`, `\bf`, `\cal`.
\new \OpTeX/
\OpTeX/ supports more such selectors `\script`, `\frak`, `\bbchar`, `\bi`, see
section 1.3.3 in the \OpTeX/ documentation. The math selectors have local
validity in the group.

The control sequences `\rm`, `\it`, `\bf`, and `\bi` act as variant selectors
of fonts in non-math mode (text mode) and they act 
as math alphabet selectors in math mode. This \"overlaying" concept 
is given by Plain \TeX/. Example: math operators lim, sin, cos,
log, etc.\ must be printed unslanted. We are using `\lim`, `\sin`, `\cos`,
`\log` etc.\ in math mode in order to comply this typographical rule. For
example `\sin` is defined as:
\begtt
\def\sin {\mathop{\rm sin}\nolimits}
\endtt
The `\rm` is used here as math alphabet selector, no variant selector of
text fonts.

The list of all predefined `\rm`-like math operators follows: `\arccos`,
`\arcsin`, `\arctan`, `\arg`, `\cos`, `\cosh`, `\cot`, `\coth`, `\deg`.
`\det`, `\dim`, `\exp`, `\gcd`, `\hom`, `\inf`, `\ker`, `\lg`, `\lim`,
`\liminf`, `\limsup`, `\ln`, `\log`, `\max`, `\min`, `\Pr`, `\scs`, `\sin`,
`\sinh`, `\sup`, `\tan`, `\tanh`, You can define another such operator
analogicaly.

\new Unicode
Unicode font can include the following math alphabets:
\begtt \typosize[9/11]
\_rmvariables      % upright letters A-Z, a-z
\_bfvariables      % bold letters A-Z, a-z
\_itvariables      % italic letters A-Z, a-z
\_bivariables      % bold italic letters A-Z, a-z
\_calvariables     % calligraphic letters A-Z, a-z
\_bcalvariables    % calligraphic letters A-Z, a-z
\_frakvariables    % fraktur A-Z, a-z
\_bfrakvariables   % bold fraktur A-Z, a-z
\_sansvaraibales   % sans serif letters A-Z, a-z
\_bsansvaraibales  % bold sans serif letters A-Z, a-z
\_isansvaraibales  % slanted sans serif letters A-Z, a-z
\_bisansvaraibales % bold slanted sans serif letters A-Z, a-z
\_ttvariables      % monospace, typewriter letters A-Z, a-z
\_bbvariables      % double struck A-Z, a-z
\_rmdigits         % upright digits 0..9
\_bfdigits         % bold digits 0..9
\_sansdigits       % sans serif digits 0..9
\_bsansdigits      % bold sans serif digits 0..9
\_ttdigits         % monospace typewriter digits 0..9
\_bbdigits         % double-struck digits 0..9
\_rmgreek          % upright greek letters \alpha-\omega
\_itgreek          % slanted greek letters \alpha-\omega
\_bfgreek          % bold greek letters \alpha-\omega
\_bigreek          % bold italic greek letters \alpha-\omega
\_bsansgreek       % bold sans serif greek letters \alpha-\omega
\_bisansgreek      % bold slanted snas serif greek letters \alpha-\omega
\_itGreek          % slanted greek letters \Alpha-\Omega
\_bfGreek          % bold greek letters \Alpha-\Omega
\_biGreek          % bold italic greek letters \Alpha-\Omega
\_bsansGreek       % bold sans serif greek letters \Alpha-\Omega
\_bisansGreek      % bold slanted snas serif greek letters \Alpha-\Omega
\endtt
%
Not all Unicode math fonts include all math alphabets listed here. Typically, 
the lowercase letters of calligraphic shape and all letters of
bold calligraphic shape are missing.

\new \OpTeX/
\OpTeX/ defines internal math alphabet selectors as mentioned in the
previous listing and sets as default:
\begtt \typosize[10/12]
\_itvariables \_rmdigits \_itgreek \_rmGreek
\endtt
%
Moreower, it defines the alphabet selectors at user level (see section 1.3.3
of the \OpTeX/ manual). For example
\begtt \typosize[10/12]
\def\rm {\_tryload\_tenrm \_inmath{\_rmavariables \_rmdigits}}
\endtt
%
The first part 
\new \OpTeX/
`\_tryload\_tenrm` is applicable for text fonts and the 
`\_inmath` part is processed only in math mode and sets the math alphabets.
You can see the file `unimath-codes.opm` where all user level selectors are
defined. You can redefine them. For example, \OpTeX/ defines `\bf` as a math
alphabet selector which selects sans serif bold in math. This is common
notation for vectors and matrices. If you dislike this, then you can define:
\begtt \typosize[10/12]
\def\bf {\_tryloadbf\_tenbf \_inmath{\_bfvariables\_bfdigits\_bfgreek\_bfGreek}}
\endtt


\secc[objects] List of single math objects

\new Unicode
All single math objects is listed in the `unimath-table.opm` or
`unicode-math-table.tex` file. You can
look into this file. The codes, \TeX/ sequences, classes and comments
for all possible math codes are here. Maybe, your Unicode math font which is loaded,
does not support all these codes. 
\new \OpTeX/
You can try all codes of currently loaded font by
\begtt
\input print-unimath.opm
\endtt
The `unimath-table` is printed with characters available in loaded font.
\new \OpTeX/
If the character is unsupported by the font then the slot is empty and only
\TeX/ sequence and the class of the code is printed in the table.
For example, this document loads `latimodern-math.otf` font.
And the result from `\input print-unimath.opm` looks like the following ten
pages.

\bigskip
\input print-unimath.opm
\bigskip

\new Unicode
All characters available in the math font can be accessed by \TeX/ control
sequence or by direct using the Unicode character in the document source.
Example:
\begtt \adef/{}
$$ 
   \sum/_{k=0}^\infty e^{(\alpha+i\beta/_k)} = 
   e^\alpha \sum/_{k=0}^\infty e^{i\beta/_k} = 
   e^\alpha \sum/_{k=0}^\infty (\cos\beta/_k + i\sin\beta/_k). 
$$
\endtt
or
\begtt \ttspec
$$
   ∑_{k=0}^∞ e^{(α + iβ_k)} = e^α ∑_{k=0}^∞ e^{iβ_k} 
                            = e^α ∑_{k=0}^∞ (\cos β_k + i\sin β_k). 
$$
\endtt
both gives the same result:
$$
  ∑_{k=0}^∞ e^{(α + iβ_k)} = e^α ∑_{k=0}^∞ e^{iβ_k} 
                           = e^α ∑_{k=0}^∞ (\cos β_k + i\sin β_k).
$$

\sec More specialities

\secc The `\not` prefix

You can apply `\not` to the following math object.
The slash $/$ is overprinted such math object, for example 
`$a \not= b$` gives $a \not= b$.

\new \OpTeX/
If there exist a direct Unicode character for negation of a relation symbol
(for example `\ne` creates $\ne$ directly as a character U+2260) 
then `\not<char>` expands to appropriate Unicode character. 
For example `\not=` expands to `\ne`. If such character does not exists then
the centered $/$ is overprinted over the next character. 

\secc The `\bulidrel` macro: text over relation

... todo

\secc Spaces

... todo

\secc Texts in math mode

... todo

\secc Three dots

... todo

\secc Phantom

... todo

\secc `\vcenter`

... todo

\sec Structured objects

\secc Matrices

... todo

\secc Cases

... todo

\sec Lines in display style

\secc `\displaylines`

... todo

\secc `\eqalign` and friends

... todo

\bye
